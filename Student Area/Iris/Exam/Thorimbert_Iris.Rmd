---
title: "Les prix nobels"
author: "Iris Thorimbert"
date: "07/11/2021"
output:
  html_document: default
  pdf_document: default
---
    
M1 MIASHS, semestre 6   
Cours de M. CROSETTO, Logiciel spécialisé R

![](nobel noir.jpg)

## **Base de données**

La base de données 'Nobel Laureate Publications' est extraite du projet *TidyTuesday* disponible sur le site *GitHub*.
Les données ont été recueillies par Georgios Karamanis qui s'est appuyé sur différents sites internets tels que la page officiel du prix nobel, celui des universités pour récolter et assembler toutes les informations.

Les prix sont décernés chaque année depuis 1901 à des personnes « ayant apporté le plus grand bénéfice à l'humanité », par leurs inventions, découvertes et améliorations dans différents domaines.

Le premier tableau, *nobel_winners*, contient donc, comme son nom l'indique, le nom des gagnants. Celui-ci est composé de 969 observations et 18 variables telles que l'année du prix (de 1901 à 2016), la catégorie (chimie, physique, littérature, médecine, économie et paix), nom du lauréat, son pays d'origine... Dans le second tableau, nommé *nobel_winner_all_pubs*, nous ai fourni des informations sur les publications écrites par les gagnants. Nous avons un tableau de 93 394 observations et 11 variables. Ainsi nous pouvons y lire, pour chaque vainqueurs, le titre et l'année de chacune de ses publications, la revue dans laquelle elle a été publié, mais également si c'est à partir de ce papier que l'individu a reçu son prix.

A partir de ces informations, nous pouvons à présent commencer notre analyse.

```{r setup, message=FALSE, warning=FALSE, echo=FALSE}
#installation package
library(tidyverse)
library(dplyr)
library(ggthemes)
library(scales)
library(knitr)
```
```{r message=FALSE, warning=FALSE}

nobel_winners <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-14/nobel_winners.csv")

nobel_winner_all_pubs <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-05-14/nobel_winner_all_pubs.csv")

```

Dans un soucis de simplification de la base de données et de son analyse, j'ai fait le choix de supprimer des données. Tout d'abord j'ai enlevé toutes les lignes rattachées au prix nobel de la paix. En effet, j'obtiens de nombreuses valeurs manquantes et, le fait que des organisations ont parfois été récompensées, cela rend notre analyse plus complexe.
Ensuite, dans un second temps, j'ai supprimé les colonnes numéro 13, 14 et 15 correspondant respectivement à *organization_name*, *organization_city* et *organization_country* car celles-ci entraînentt un doublon de certain lauréat. C'est donc pour supprimer ces doublons que j'execute la commande *unique*.

```{r}
# nettoyage de la base de données

nobel <- nobel_winners %>% 
  .[!nobel_winners$category=="Peace",] %>%    # suppression de tous les prix associés à Peace
  .[-c(13,14,15)]                             # suppression de ces colonnes 

nobel_no_doublon <- unique(nobel[ 1:839,])    # suppression des doublons
```

A partir de maintenant nous avons donc 781 observation et 15 variables.


## **Questions**

#### **Combien de femmes ont gagné un prix nobel?**

```{r}
a <- str_count(nobel_no_doublon$gender, 'Female') #créer une matrice 1 et 0 
a <- sum(a,na.rm = T) #compte le nombre de 1
kable(a, align = "l")
```


#### **Qu'est-ce que cela représente par rapport aux hommes?**

```{r}
nobel_no_doublon %>% 
  select(gender) %>% 
  ggplot()+
  aes(x = gender, fill = gender)+
  geom_bar()+
  theme_classic()+
  labs(title = "Nombre de prix obtenus en fonction du genre", y = "Nombre")+
  theme(plot.title = element_text(hjust = 0.5))+
  annotate("text", x = 1, y = 65, label = 33, color = '#999999')+
  annotate("text", x = 2, y = 780, label = 748, color = '#999999')
  
```

#### **Qu'est-ce que cela représente en pourcentage?**

```{r}
pourcentage_f = 33/781*100
pourcentage_h = 748/781*100
pourcentage_f <- round(pourcentage_f, digits = 2) #2 chiffres après la virgule
pourcentage_h <- round(pourcentage_h, digits = 2)

# Création d'une table comprennant les pourcentages trouvés au-dessus : 
table <- data.frame( Sexe = c("Male", "Female"),
                     Pourcentage = c(pourcentage_h, pourcentage_f))

#graphique en colonne
barre <- table %>% 
  ggplot()+
  aes(x = "",y = Pourcentage, fill = Sexe)+
  geom_col()

#transformer en camembert
pie <- barre +
        coord_polar(theta = "y")

#Mise en page du camembert
blank_theme <- theme_minimal() + 
  theme(
    axis.title.x = element_blank(),
    axis.title.y = element_blank(),#on enleve les nom des axes x et y
    panel.border = element_blank(),
    panel.grid=element_blank(),
    axis.ticks = element_blank())+ 
    theme(axis.text.x = element_blank()) #on enleve les valeurs des axes

pie +
  blank_theme + labs(title = "Nombre de prix obtenus en fonction du genre")+
  theme(plot.title = element_text(hjust = 0.5))+
  geom_text(aes(y = Pourcentage/2 + c(0, cumsum(Pourcentage)[-length(Pourcentage)]),
                label = percent(Pourcentage/100)), size=3.3, color = 'black') # ajout des chiffres

```




#### **En quelle année les femmes ont reçu leurs prix**     

```{r}
# création d'une base pour faciliter la visualisation 
femme <- nobel_no_doublon %>% 
  filter(gender == "Female") %>% 
  select(prize_year,category, full_name, prize_share)

nobel_no_doublon %>% 
  filter(gender =="Female") %>% 
  group_by(prize_year ) %>% 
  count(prize_year) %>%  
  ggplot(aes(x = prize_year, y=n))+
  geom_point(color = "#FF6666")+ 
  scale_x_continuous(breaks = c(1903, 1911, 1926, 1935, 1945, 1963, 1977, 1986, 1996, 2007, 2014),
                     limits = c(1900,2016))+
  scale_y_continuous(breaks = c(1:6),limits = c(0,6))+
  theme_classic()+
  labs(title = "Nombre de femmes ayant reçu un prix nobel de 1901 à 2016", y = "nombres")+
  theme(plot.title = element_text(hjust = 0.5))+
  annotate("text", x = 2004, y = 2.3, label = 2004, color = '#999999', size = 3)+
  annotate("text", x = 2009, y = 5.3, label = 2009, color = '#999999', size = 3)+
  annotate("text", x = 2015, y = 2.3, label = 2015, color = '#999999', size = 3)

```

**Remarque :** On peut constater qu'en 2009, 5 femmes ont remporté un prix. Sachant que nous analysons ici une base pour 5 prix nobels : chimie, physique, médecine, littérature et économie (puisque nous avons enlevé le prix nobel de la paix), nous pouvons donc supposer que toutes les matières ont été gagné par une femme. En revanche, lorsque nous analysons plus en détail la base de données, nous pouvons constater que le prix nobel de physique a été gagné par un homme. Cela paraît donc étrange et nous fait interroger sur la véracité de nos résultats. Pourtant la raison est parfaitement logique : le prix peut être partager par plusieurs personnes. En effet, nous avons une colonne *prize_share* qui nous permet d'observer avec combien de personne le prix a été partagé. Ainsi, si l'on revient à l'année 2009, nous sommes en mesure de constater que le prix nobel de médecine à été partagé entre 3 personnes, 2 femmes et un homme.    



#### **Combien sont les individus qui partagent un prix à plusieurs?**


c("1personne","2 personnes", "3 personnes", "4 personnes")


```{r}
nobel_no_doublon %>% 
  group_by(prize_share) %>% 
  summarise(N = n()) %>% 
  ggplot(aes(prize_share, N, fill = prize_share)) +
  geom_bar(stat = "identity") +
  theme_classic()+
  labs(title = "Répartition du partage des prix", x = "", y = "nombres")+
  geom_text(aes(label = N, vjust = -0.5), color = "#999999", size = 4) +
  theme(plot.title = element_text(hjust = 0.5))+
  theme(legend.position='none')  

```

#### **Par groupe, combien y a-t-il d'hommes et de femmes?**

faire tableau
```{r}

prix <- nobel_no_doublon %>% 
  group_by(gender, prize_share) %>% 
  select(gender, prize_share) %>% 
  mutate(N = n()) %>% 
  unique()

#prix2 <- prix %>% 
 # pivot_wider(cols= -gender, names_to =prize_share)
```

```{r}
table4a %>% 
  pivot_longer(cols = -country ,names_to = "année", values_to = "cas")
# on ordonne toutes les varaibles qui ne sont pas dans la colonne country, on met les valeurs qui ne sont pas de le tableau dans la variable année, et les données qui était dedans sont mis dans la colonne cas
```

## 2. pivot_wider
```{r}
y <- table2 # il est trop long, une obs est reparti sur deux lignes donc on veut le rendre plus large
```
pivot_wider
```{r}
z <- table2 %>% 
  pivot_wider(names_from = type, values_from = count)
#on prend les noms de types et on en fait des colonnes et les valeurs associés viennent de la colonne count
```






#### **Combien de nationalité ont obtenu un prix nobel?**
```{r}
b <- nobel_no_doublon %>% 
  select(birth_country) %>% 
  unique() %>% 
  count()
kable(b, align = "l")
```

Nous avons donc 104 nationalités différentes qui ont un jour gagné un prix nobel.
Sachant qu'il y a 195 pays dans le monde, environ un pays sur 2 a un jour été récompensé. 
Cependant ce résultat est également à prendre à la légère car nous prenons ici le pays de naissance du lauréat. Or certain individu ont, entre temps, changer de nationnalité ou travailler dans un autre pays. Nous pouvons prendre comme exemple Marie Curie, né en Pologne puis naturalisée française après son mariage. Le prix nobel de physique qu'elle a obtenu en 1903 est donc affiché dans notre base comme polonais par elle mais également français par son mari Pierre Curie.
De plus, comme notre base de donnée commence au début du 20ème siècle, nous avons des pays qui aujoud'hui n'existe plus et qui entraine une augmentation du nombre de pays ayant gagné un prix. Nous avons par exemple *Prussia* qui peut apparaître sous 3 formes :   
  - Prussia (Poland)   
  - Prussia (Germany)   
  - Prussia (Russia)    


```{r message=FALSE, warning=FALSE, echo=FALSE}
nobel_no_doublon %>% 
  select(birth_country) %>% 
  filter(birth_country == "Prussia (Poland)"| birth_country == "Prussia (Germany)"| birth_country == "Prussia (Russia)") %>%  
  unique()
```


#### **Quel est le top 10 des nationalités les plus nominées?**

```{r message=FALSE, warning=FALSE}
nobel_no_doublon %>% 
  group_by(birth_country) %>% 
  summarise(N = n()) %>%
  top_n(10) %>% 
  ggplot(label = N)+
  scale_x_continuous(limits = c(0,255))+
  aes(y = reorder(birth_country, -N), N)+
  geom_col(color = "#FFCC00", fill="#FFCC00")+
  geom_text(aes(label = N, hjust=-0.5), color="#999999") +
  theme_classic()+
  labs(title = "Top 10 des pays les plus nominés", x = "nombres", y = "pays")+
  theme(plot.title = element_text(hjust = 0.5))

```



#### **Et le top 5 par matière?**

```{r message=FALSE, warning=FALSE}
nobel_no_doublon %>% 
  group_by(category, birth_country ) %>% 
  summarise(N = n()) %>% 
  top_n(5) %>% 
  ggplot()+
  aes(x = birth_country, y = N, fill= birth_country)+
  geom_col()+
  facet_wrap(~category, scales = "free") +
  coord_flip()+
  geom_text(aes(label = N, hjust=-0.5), color="#999999") +
  theme_classic()+
  labs(title = "Top 5 des pays les plus nominés par catégorie", )+
  theme(plot.title = element_text(hjust = -0.5))+
  theme(legend.position='none')

```


#### **Combien de personnes ont obtenu plusieurs prix nobels?**

```{r}

```

#### **Et dans deux matières différentes?**
```{r}

```

Marie curie est la seule a en avoir obtenu dans deux domaines différents : celui de la physique en 1903 et de la chimie en 1911.





Idée de question

 
3. plusieurs fois eu un prix ?
 et dans deux domaines différents?

6. nombre de publication avant d'avoir un prix?

 est ce que le nombre de publication a un impact sur la probabilité d'avoir un prix?
 8. motivation des individus principales? ou tel ou tel type de motiv




