---
title: "Rapport statistique"
author: "MUTAMU TONY DASSIN"
date: "15/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Installation des packages "tidyverse" et "tidytuesdayR" 

```{r}
install.packages("tidytuesdayR")
install.packages("tidyverse")
```

Lancement de la library "tidyverse" et "tidytuesdayR" et récupération des données

```{r}
library(tidytuesdayR)
library(tidyverse)

tuesdata <- tidytuesdayR::tt_load('2021-01-26')
tuesdata <- tidytuesdayR::tt_load(2021, week = 5)

plastics <- tuesdata$plastics

```

# Code de fusion des bases données

library(fs)

files_2020 <- fs::dir_ls("2020 BFFP National Data Results") %>% 
  str_subset("csv")

files_2019 <- fs::dir_ls("2019 Brand Audit Appendix _ Results by Country/Countries") %>% 
  str_subset("csv")

data_2020 <- files_2020 %>% 
  map_dfr(read_csv, col_types = cols(
    Country = col_character(),
    Parent_company = col_character(),
    Empty = col_double(),
    HDPE = col_double(),
    LDPE = col_double(),
    O = col_double(),
    PET = col_double(),
    PP = col_double(),
    PS = col_double(),
    PVC = col_double(),
    Grand_Total = col_character(),
    num_events = col_double(),
    volunteers = col_double()
  )) %>% 
  mutate(year = 2020, .after = Country) %>% 
  mutate(Grand_Total = parse_number(Grand_Total)) %>% 
  janitor::clean_names()

data_2019 <- files_2019 %>% 
  set_names(str_replace(., ".*[/]([^.]+)[.].*", "\\1")) %>% 
  map_dfr(read_csv, .id = "country", col_types = cols(
    Country = col_character(),
    Parent_company = col_character(),
    Empty = col_double(),
    HDPE = col_double(),
    LDPE = col_double(),
    O = col_double(),
    PET = col_double(),
    PP = col_double(),
    PS = col_double(),
    PVC = col_double(),
    Grand_Total = col_double(),
    num_events = col_double(),
    volunteers = col_double()
  )) %>% 
  select(country, everything()) %>% 
  mutate(year = 2019, .after = country) %>% 
  janitor::clean_names()  %>% 
  mutate(pp = if_else(is.na(pp_2), pp, pp_2 + pp),
         ps = if_else(is.na(ps_2), ps, ps + ps_2)) %>% 
  rename(parent_company = parent_co_final, num_events = number_of_events, volunteers= number_of_volunteers) %>% 
  select(-ps_2, -pp_2)

combo_data <- bind_rows(data_2019, data_2020) 

combo_data %>% 
  write_csv("2021/2021-01-26/plastics.csv")




- Nettoyage de la base de données

Renommage des variables non-explicites
```{r}

plastics <- plastics %>% 
  rename( Pays = country ,Année = year, Source_plastic = parent_company , Cat_vide= empty, Cat_autre= o ,Polyester= pet , Polypropylene = pp ,Polystyrene = ps , Nombre_even = num_events , Volontaires = volunteers )
```


Omission des valeurs manquantes de la base de données

```{r} 
plastique <- na.omit(plastics)
view(plastique)
```


- Questions


Statistiques descriptives 
```{r}
summary(plastique)

names(plastique)

dim(plastique)

```

Boxplot
```{r}
 BP<- plastique %>% 
  filter(plastique, Année = 2019) %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(Année, Pays)+
 geom_boxplot(varwidth=T, fill="red")
BP

```


Pour chaque type de plastique , le pays qui en pollue le plus ?

Lancement de la library "ggplot2"

```{r}
library(ggplot2)
```

```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= hdpe, y=Pays)+
  geom_bar(stat='identity')
```

```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= ldpe, y=Pays)+
  geom_bar(stat='identity')
```

```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polyester , y=Pays)+
  geom_bar(stat='identity')
  
```


```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polypropylene , y=Pays)+
  geom_bar(stat='identity')
  
```


```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polystyrene , y=Pays)+
  geom_bar(stat='identity')
  
```


```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= PVC , y=Pays)+
  geom_bar(stat='identity')
  
```

Quel pays pollue le plus en plastique en générale ?

```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= grand_total, y=Pays)+
  geom_bar(stat='identity', aes(fill= Année))
```


En quelle année la pollution de plastique a t-elle était la plus élevée

```{r}
barre <- mpg %>% 
  ggplot()+
  aes(x = "", y = class, fill = class)+
  geom_col()

barre
```

Groupement des pays par volontaires et nombre d'événements

```{r}

NBP<- plastique %>% 
    as_tibble() %>% 
    count(Pays,Année,Volontaires, Nombre_even)

```

Diiférentes sources de plastique .
```{r}
NBS<- plastique %>% 
    as_tibble() %>% 
    count(Source_plastic)
```

Quel est le pays avec le plus de volontaires ?

```{r}
plastique %>% 
  group_by(Pays) %>% 
ggplot()+
  aes(x= Volontaires ,y= Pays)+
  geom_bar(stat='identity', aes(fill=Année))

```

Pour chaque pays , combiens a-t'on de volontaires ?

```{r}
plastique %>% 
  
sum(Volontaires)
```

Sur la carte 
```{r}
DT <- plastique %>% 
  group_by(Pays)

```

