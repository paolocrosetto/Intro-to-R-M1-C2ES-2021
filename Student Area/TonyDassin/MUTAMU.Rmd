---
title: "Rapport statistique"
author: "MUTAMU TONY DASSIN"
date: "15/11/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

Installation des packages "tidyverse" et "tidytuesdayR" 


install.packages("tidytuesdayR")
install.packages("tidyverse")

Lancement de la library "tidyverse" et "tidytuesdayR" et récupération des données




```{r}
#install.packages("tidyverse")
#install.packages("tidytuesdayR")
library(tidyverse)

plastics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-01-26/plastics.csv')


```




# Code de fusion des bases données

library(fs)

files_2020 <- fs::dir_ls("2020 BFFP National Data Results") %>% 
  str_subset("csv")

files_2019 <- fs::dir_ls("2019 Brand Audit Appendix _ Results by Country/Countries") %>% 
  str_subset("csv")

data_2020 <- files_2020 %>% 
  map_dfr(read_csv, col_types = cols(
    Country = col_character(),
    Parent_company = col_character(),
    Empty = col_double(),
    HDPE = col_double(),
    LDPE = col_double(),
    O = col_double(),
    PET = col_double(),
    PP = col_double(),
    PS = col_double(),
    PVC = col_double(),
    Grand_Total = col_character(),
    num_events = col_double(),
    volunteers = col_double()
  )) %>% 
  mutate(year = 2020, .after = Country) %>% 
  mutate(Grand_Total = parse_number(Grand_Total)) %>% 
  janitor::clean_names()

data_2019 <- files_2019 %>% 
  set_names(str_replace(., ".*[/]([^.]+)[.].*", "\\1")) %>% 
  map_dfr(read_csv, .id = "country", col_types = cols(
    Country = col_character(),
    Parent_company = col_character(),
    Empty = col_double(),
    HDPE = col_double(),
    LDPE = col_double(),
    O = col_double(),
    PET = col_double(),
    PP = col_double(),
    PS = col_double(),
    PVC = col_double(),
    Grand_Total = col_double(),
    num_events = col_double(),
    volunteers = col_double()
  )) %>% 
  select(country, everything()) %>% 
  mutate(year = 2019, .after = country) %>% 
  janitor::clean_names()  %>% 
  mutate(pp = if_else(is.na(pp_2), pp, pp_2 + pp),
         ps = if_else(is.na(ps_2), ps, ps + ps_2)) %>% 
  rename(parent_company = parent_co_final, num_events = number_of_events, volunteers= number_of_volunteers) %>% 
  select(-ps_2, -pp_2)

combo_data <- bind_rows(data_2019, data_2020) 

combo_data %>% 
  write_csv("2021/2021-01-26/plastics.csv")




- Nettoyage de la base de données


Omission des valeurs manquantes de la base de données


- Présentation des variables explicatives

![](C:/Users\\mtdas\\Documents\\Logiciels\\Intro-to-R-M1-C2ES-2021\\Student Area\\TonyDassin\\Variables.png)



Renommage des variables non-explicites
```{r}

plastics <- plastics %>% 
  rename( Pays = country ,Année = year, Source_plastic = parent_company , Cat_vide= empty, Cat_autre= o ,Polyester= pet , Polypropylene = pp ,Polystyrene = ps , Nombre_even = num_events , Volontaires = volunteers )
```


```{r} 
plastique <- na.omit(plastics)

```


- Questions


Statistiques descriptives 
```{r}
summary(plastique)

names(plastique)

dim(plastique)

```

Boxplot

```{r}

```



- Pour chaque type de plastique , quel est le pays qui en pollue le plus ?

Lancement de la library "ggplot2"

```{r}
library(ggplot2)
```

hdpe


plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  +
  geom_bar(stat='identity')


ldpe
```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= ldpe, y=Pays)+
  geom_bar(stat='identity')
```
Polyester
```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polyester , y=Pays)+
  geom_bar(stat='identity')
  
```
Polypropylene

```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polypropylene , y=Pays)+
  geom_bar(stat='identity')
  
```

Polystyrene
```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= Polystyrene , y=Pays)+
  geom_bar(stat='identity')
  
```

pvc
```{r}
plastique %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= pvc , y=Pays)+
  geom_bar(stat='identity')
  
```

Quel pays pollue le plus en plastique en générale  en 2019 ?

```{r}
plastique %>% 
  filter(Année=="2019") %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= grand_total, y=Pays)+
  geom_bar(stat='identity', aes(fill= Année))
```


Quel pays pollue le plus en plastique en générale  en 2020 ?

```{r}
plastique %>% 
  filter(Année=="2020") %>% 
  group_by(Pays) %>% 
  ggplot()+
  aes(x= grand_total, y=Pays)+
  geom_bar(stat='identity', aes(fill= Année))
```


En quelle année la pollution de plastique a t-elle était la plus élevée


Groupement des pays par volontaires et nombre d'événements

```{r}

NBP<- plastique %>% 
    as_tibble() %>% 
    count(Pays,Année,Volontaires, Nombre_even)

```

Différentes sources de plastique .
```{r}
NBS<- plastique %>% 
    as_tibble() %>% 
    count(Source_plastic)
```

Quel est le pays avec le plus de volontaires ?

```{r}
plastique %>% 
  group_by(Pays) %>% 
ggplot()+
  aes(x= Volontaires ,y= Pays)+
  geom_bar(stat='identity', aes(fill=Année))

```

Pour chaque pays , combiens a-t'on de volontaires ?


