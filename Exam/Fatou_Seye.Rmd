---
title: "Rapport R"
author: "Fatou Seye"
date: "03/11/2021"
output: html_document
---


###  Cette base de données porte sur la pollution en plastique et elle vient de l'association Break Free From Plastic. Cette dernière lutte contre la pollution, notamment les déchets plastiques qui sont rejetés par les grandes entreprises de fabrication. Ce sujet est très intéressant, il est d'ailleurs toujours d'actualité, on va ainsi faire des manipulations avec cette de données pour en aprrendre plus sur la pollution en plastique pendant les années 2019 et 2020. 

```{r}
library(tidytuesdayR)
library(tidyverse)
```


### Importation des données :

```{r}
tuesdata <- tidytuesdayR::tt_load('2021-01-26')
tuesdata <- tidytuesdayR::tt_load(2021, week = 5)
```


```{r}
plastics <- tuesdata$plastics

```

# supprimons les valeurs manquantes 
```{r}
df = na.omit(plastics)
```


## Questions : 

### **1. Combien y a t-il de volontaires dans le mouvement Break Free From Plastic ?

```{r}

nb_vol<- df$volunteers
summary(nb_vol)


```



### On peut voir qu'il a en tout 6850 volontaires dans le mouvement Break Free Plastic

### **2. Combien y a t-il de déchets plastiques en tout ?

```{r}
nb_dechet <- df %>% 
  select(grand_total) %>% 
  summary(grand_total)

nb_dechet
```
### En tout le mouvement Break Free Plastic a recencé 80570 déchets en plastique 


### **3. Combien d'évenement ont eu lieu dans le mouvement depuis 2019 ?

```{r}

nb_events <- summary(df$num_events)

 

```

### Il y a eu 134 évenements dans le mouvement


### **4. Est ce qu'il y a un lien entre le nombre de déchet total et le nombre de volontaires ?

```{r}

df %>% 
  mutate(n_vol = volunteers ) %>% 
  drop_na(n_vol) -> corr_2
cor(corr_2$n_vol, with(corr_2, grand_total))

```
### On voit que d'après notre résultat il y a presque pas de lien entre le nombre de volontaires dans le mouvement et le nombre de déchet total.


### **5.Quels sont les 5 compagnies les plus polluantes en Brazil?

```{r}
df %>% 
  filter(country == "Brazil") %>% 
  group_by(parent_company) %>% 
  summarize(N = max(grand_total)) %>% 
  top_n(5) %>% 
  ggplot()+
  aes(x= reorder(parent_company , -N), N, fill = parent_company)+
  geom_col()


```



### **6. Y'a t-il une corrélation entre les évenements de comptage et la quantité de déchets en plastiques?


```{r}
df %>% 
  group_by(num_events) %>% 
  summarise(grand_total = mean(grand_total, na.rm = T)) %>% 
  ggplot()+
  aes(num_events, grand_total , color = num_events)+
  geom_point()+
  geom_smooth(method = "lm")

```




### **7. Quelle est la proportion de la pollution de plastique dans ces 5 pays?

```{r}
df %>% 
  filter(country %in% c( "Argentina" , "Brazil" , "Bangladesh", "China" ,"Canada")) %>% 
  group_by(year) %>% 
  ggplot()+
  aes(x = grand_total , y = country , fill = grand_total)+
  geom_col()
  
  
```


### **8. Quelle est la différence de participation entre les volontaires selon les pays?

```{r}
particip<- df %>% 
  group_by(country , year) %>% 
  summarise(y_events = mean(num_events, na.rm = TRUE) ,
            y_volunteers = mean(volunteers, na.rm = TRUE)) %>% 
  pivot_wider(id = "country", names_from = "year", values_from = c("y_events" , "y_volunteers")) %>% 
  ungroup() %>% 
  mutate(dif_volunteers = y_volunteers_2020 - y_volunteers_2019 )

particip
```


### **9. Quel est le pays qui pollue le plus en 2019 ? (en considérant les 20 premiers pays)

```{r}
data<- df %>% 
  filter(year == "2019" ) %>% 
  group_by(country, grand_total) %>% 
  summarize(N = n()) %>% 
  top_n(20)


data %>% 
  ggplot()+
  aes(x = country , y = grand_total , fill = country)+
  geom_col()+
  coord_flip()

```

### **10. Quel est le pays qui pollue le plus en 2020?

```{r}

data2 <- df %>% 
  filter(year == "2020" ) %>% 
  group_by(country, grand_total) %>% 
  summarize(N = n()) %>% 
  top_n(20)


data2 %>% 
  ggplot()+
  aes(x = reorder(country , -N), N , fill = grand_total)+
  geom_col()+
  coord_flip()

```


